<!DOCTYPE html>
<html>
<head>
  <title>Buscador</title>
 <style>
  /* Estilos CSS para la página */
  body {
    font-family: Arial, sans-serif;
  }
  .container {
    max-width: 500px;
    margin: 0 auto;
    padding: 20px;
  }
  .search-form {
    display: flex;
    margin-bottom: 10px; /* Espacio entre la caja de búsqueda y el botón */
  }
  .search-form input[type="text"] {
    flex: 1;
    padding: 10px;
    font-size: 16px;
  }
  .search-form input[type="submit"] {
    background-color: #4CAF50;
    color: white;
    border: none;
    padding: 10px 20px;
    font-size: 16px;
    cursor: pointer;
    margin-left: 10px; /* Espacio entre la caja de búsqueda y el botón */
  }
  .search-results {
    margin-top: 20px;
  }
</style>
</head>
<body>
  <div class="container">
    <h1>Buscador</h1>
    <form class="search-form">
      <input type="text" name="search-term" placeholder="Ingrese el término de búsqueda">
      <input type="submit" value="Buscar">
    </form>
    <div class="search-results">
      <!-- Aquí se mostrarán los resultados de la búsqueda -->
    </div>
  </div>

  <script>
    // Función para realizar la búsqueda en Google Sheets
    function searchInGoogleSheets(searchTerm) {
      // ID de la hoja de cálculo de Google Sheets
      var spreadsheetId = '1uxwfQA1Dj7XHechUB2GWaYhq-VPl2rMzPepNSE3zDtM';

      // Nombre de la hoja de cálculo en la que se realizará la búsqueda
      var sheetName = 'shutterstock';

      // Credenciales de autenticación de la API de Google Sheets
      var apiKey = 'AIzaSyDCWMQksGjZpej-HmgTNe2fP_HQp4og0Bc'; // Reemplaza con tu propia API Key

      // Construir la URL de la solicitud a la API de Google Sheets
      var url = `https://sheets.googleapis.com/v4/spreadsheets/${spreadsheetId}/values/${sheetName}?key=${apiKey}`;

      // Realizar la solicitud GET para obtener los datos de la hoja de cálculo
      fetch(url)
        .then(function(response) {
          return response.json();
        })
        .then(function(data) {
          var rows = data.values;
          var results = [];

          // Recorrer las filas y buscar el término de búsqueda en la columna A
          for (var i = 0; i < rows.length; i++) {
            if (rows[i][0] && rows[i][0].includes(searchTerm)) {
              results.push(rows[i][1]); // Agregar el valor de la columna B al resultado
            }
          }

          // Mostrar los resultados en la página web
          var resultsContainer = document.querySelector('.search-results');
          resultsContainer.innerHTML = '';

          if (results.length > 0) {
            for (var k = 0; k < results.length; k++) {
              var resultLink = document.createElement('a');
              resultLink.href = results[k]; // Establecer la URL como el resultado
              resultLink.textContent = results[k]; // Establecer el texto del enlace como el resultado
              resultLink.target = '_blank'; // Abrir enlace en una nueva pestaña
              resultLink.rel = 'noopener noreferrer'; // Configurar atributos de seguridad para enlaces externos
              resultsContainer.appendChild(resultLink);
              resultsContainer.appendChild(document.createElement('br'));
            }
          } else {
            var noResultsMessage = document.createElement('p');
            noResultsMessage.textContent = 'No se encontraron resultados.';
            resultsContainer.appendChild(noResultsMessage);
          }
        })
        .catch(function(error) {
          console.log('Error al obtener los datos de Google Sheets:', error);
        });
    }

    // Obtener el formulario de búsqueda
    var searchForm = document.querySelector('.search-form');

    // Agregar un evento de envío de formulario
    searchForm.addEventListener('submit', function(event) {
      event.preventDefault();
      var searchTerm = searchForm.querySelector('input[name="search-term"]').value;

      // Validar si se ingresó un término de búsqueda
      if (searchTerm.trim() !== '') {
        searchInGoogleSheets(searchTerm);
      } else {
        var resultsContainer = document.querySelector('.search-results');
        resultsContainer.innerHTML = '';

        var noResultsMessage = document.createElement('p');
        noResultsMessage.textContent = 'Por favor, ingrese un término de búsqueda.';
        resultsContainer.appendChild(noResultsMessage);
      }
    });
  </script>
</body>
</html>
